---
import { getCollection } from 'astro:content';
import Chart from './chart.tsx';

const reviews = await getCollection('reviews');

const ratingCounts: { [rating: number]: number } = {
    1: 0,
    2: 0,
    3: 0,
    4: 0,
    5: 0
};
reviews.forEach(review => {
    const rating = review.data.rating;
    ratingCounts[rating]++;
});
const chartData = Object.keys(ratingCounts).map(rating => ({
    name: rating,
    count: ratingCounts[parseInt(rating)]
}));
---
<Chart chartData={chartData} client:load />